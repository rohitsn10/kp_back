<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Request for Inspection (RFI) and Release Note</title>
    <style>
        @page {
            size: A4;
            margin: 10mm 10mm 10mm 10mm;
        }
        
        body {
            font-family: Arial, sans-serif;
            font-size: 10px;
            line-height: 1.2;
            margin: 0;
            padding: 0;
            width: 210mm; /* A4 width */
        }
        
        .form-container {
            width: 100%;
            max-width: 190mm; /* A bit less than A4 width to ensure fit */
            margin: 0 auto;
            border: 1px solid #000;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
            page-break-inside: avoid;
        }
        
        th, td {
            border: 1px solid #000;
            padding: 3px;
            vertical-align: top;
            word-wrap: break-word;
            font-size: 10px;
        }
        
        .header {
            font-weight: bold;
            background-color: #f9f9f9;
            text-align: center;
        }
        
        .logo {
            width: 50px;
            height: auto;
            display: block;
            margin: 3px auto;
        }
        
        .title {
            font-size: 14px;
            font-weight: bold;
            text-align: center;
            display: flex;
            flex-direction: row;
            justify-content: center;
        }
        
        .subtitle {
            font-weight: bold;
            text-align: center;
            background-color: #f0f0f0;
            padding: 3px;
        }
        
        .checkbox-container {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        /* Checkbox styling for both the filled and empty states */
        .checkbox {
            width: 10px;
            height: 10px;
            border: 1px solid #000;
            border-radius: 50%;
            display: inline-block;
            margin: 0 2px;
            position: relative;
            vertical-align: middle;
        }
        
        /* Use text directly for checkmarks to improve PDF compatibility */
        .checkbox-text {
            display: inline-block;
            width: 10px;
            text-align: center;
            vertical-align: middle;
            margin-right: 2px;
            font-weight: bold;
        }
        
        .center-text {
            text-align: center;
        }
        
        .signatures {
            height: 30px;
        }
        
        .red-text {
            color: red;
        }
        
        .doc-number {
            text-align: left;
            font-size: 9px;
            font-weight: bold;
        }
        
        .empty-row {
            height: 60px;
        }
        
        /* Responsive column widths */
        .table-cell-15 {
            width: 15%;
        }
        
        .table-cell-20 {
            width: 20%;
        }
        
        .table-cell-25 {
            width: 25%;
        }
        
        .table-cell-30 {
            width: 30%;
        }
        
        .table-cell-40 {
            width: 40%;
        }
        
        .table-cell-50 {
            width: 50%;
        }
        
        .table-cell-55 {
            width: 55%;
        }
        
        .table-cell-70 {
            width: 70%;
        }
        
        /* Compact option labels */
        .option-label {
            display: inline-block;
            margin-left: 3px;
            vertical-align: middle;
            font-size: 9px;
        }
        
        /* Smaller text for descriptions */
        .small-text {
            font-size: 8px;
            line-height: 1.1;
        }
        
        /* Flex container for options */
        .options-container {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .option-item {
            display: flex;
            align-items: center;
            margin-right: 5px;
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <div class="form-container">
        <table>
            <tr>
                <td style="width: 10%; padding: 3px;">
                    <div style="border: 1px solid #000; padding: 3px; width: 50px; height: 30px; text-align: center;">
                        <img style="width: 40px; height: 40px;" src="./logo.png"/>
                    </div>
                </td>
                <td style="width: 70%; padding-top: 10px;">
                    <div class="title">REQUEST FOR INSPECTION (RFI) AND RELEASE NOTE</div>
                </td>
                <td style="width: 20%; padding-top: 5px;">
                    <div class="doc-number">
                        Doc. No.:-KPG/PR-GM/ F65<br>
                        Rev. No./ Date: 00/07.09.2024
                    </div>
                </td>
            </tr>
        </table>

        <table>
            <tr>
                <td class="table-cell-15">Date:</td>
                <td class="table-cell-55">Project Name: {{ project }}</td>
                <td class="table-cell-30">Project Location: {{ location_name }}</td>
            </tr>
        </table>

        <table>
            <tr>
                <td class="table-cell-15">RFI No.: {{ rfi_number }}</td>
                <td class="table-cell-40">
                    <div class="options-container">
                        <div class="option-item">
                            <span class="checkbox-text">{% if 'Table Work' in rfi_classification %}✓{% else %}□{% endif %}</span>
                            <span class="option-label">Table Work</span>
                        </div>
                        <div class="option-item">
                            <span class="checkbox-text">{% if 'Buildings' in rfi_classification %}✓{% else %}□{% endif %}</span>
                            <span class="option-label">Buildings</span>
                        </div>
                        <div class="option-item">
                            <span class="checkbox-text">{% if 'Others' in rfi_classification %}✓{% else %}□{% endif %}</span>
                            <span class="option-label">Others</span>
                        </div>
                    </div>
                </td>
                <td class="table-cell-45">
                    <div class="options-container">
                        <div class="option-item">
                            <span class="checkbox-text">{% if 'Civil' in rfi_activity %}✓{% else %}□{% endif %}</span>
                            <span class="option-label">Civil</span>
                        </div>
                        <div class="option-item">
                            <span class="checkbox-text">{% if 'Electrical' in rfi_activity %}✓{% else %}□{% endif %}</span>
                            <span class="option-label">Electrical</span>
                        </div>
                        <div class="option-item">
                            <span class="checkbox-text">{% if 'Mechanical' in rfi_activity %}✓{% else %}□{% endif %}</span>
                            <span class="option-label">Mechanical</span>
                        </div>
                    </div>
                </td>
            </tr>
        </table>

        <table>
            <tr>
                <td class="table-cell-15">EPC Name:</td>
                <td class="table-cell-55">{{ epc_name }}</td>
                <td class="table-cell-30">Offered Date: {{ offered_date }}</td>
            </tr>
        </table>

        <table>
            <tr>
                <td colspan="4" class="subtitle">Details of Work Activity</td>
            </tr>
            <tr>
                <td class="table-cell-15">Block No.</td>
                <td class="table-cell-20">Table Nos.</td>
                <td class="table-cell-40">Activity Description</td>
                <td class="table-cell-25">Hold Details (If Any)</td>
            </tr>
            <tr>
                <td style="height: 40px;">{{ block_number }}</td>
                <td>{{ table_number }}</td>
                <td>{{ activity_description }}</td>
                <td>{{ hold_details }}</td>
            </tr>
        </table>

        <table>
            <tr>
                <td class="table-cell-50">Buildings/Location Name:</td>
                <td class="table-cell-50">Construction Activity:</td>
            </tr>
            <tr>
                <td style="height: 40px;">{{ location_name }}</td>
                <td>{{ construction_activity }}</td>
            </tr>
        </table>

        <table>
            <tr>
                <td class="table-cell-50 center-text">
                    The offered work output is as per engineering<br>
                    drawings and quality standards
                    <div class="signatures"></div>
                    <div class="center-text">EPC Sign, Name & Date</div>
                </td>
                <td class="table-cell-50 center-text">
                    Supervised by
                    <div class="signatures"></div>
                    <div class="center-text">KPI Construction Engineer, Sign & Date</div>
                </td>
            </tr>
        </table>

        <!-- Second part of the form -->
        <table>
            <tr>
                <td colspan="5" class="subtitle">Disposition</td>
            </tr>
            <tr>
                <td style="width: 20%; text-align: center;">
                    <span class="checkbox-text">{% if disposition == 'Released' %}✓{% else %}□{% endif %}</span>
                    <div>Released</div>
                    <div class="small-text">Released RFI as <span class="red-text">100% samples are compliant</span></div>
                </td>
                <td style="width: 20%; text-align: center;">
                    <span class="checkbox-text">{% if disposition == 'Sort' %}✓{% else %}□{% endif %}</span>
                    <div>Sort</div>
                    <div class="small-text">Sort rejected work activity for Compliant & Non-Compliants outputs and offer Compliant for Re-inspection</div>
                </td>
                <td style="width: 20%; text-align: center;">
                    <span class="checkbox-text">{% if disposition == 'Rework' %}✓{% else %}□{% endif %}</span>
                    <div>Rework</div>
                    <div class="small-text">Rework to correct the defects and offer for Re-inspection</div>
                </td>
                <td style="width: 20%; text-align: center;">
                    <span class="checkbox-text">{% if disposition == 'Use As-Is' %}✓{% else %}□{% endif %}</span>
                    <div>Use As-Is/ Deviate</div>
                    <div class="small-text">Authorize deviation to "Use as is". The deviation to be authorized by Engineering function including life of allowed deviation</div>
                </td>
                <td style="width: 20%; text-align: center;">
                    <span class="checkbox-text">{% if disposition == 'Reject' %}✓{% else %}□{% endif %}</span>
                    <div>Reject & Hold</div>
                    <div class="small-text">Rejected and hold back if previous four disposition are not agreed NCR No.</div>
                </td>
            </tr>
        </table>
            
        <table>
            <tr>
                <td style="width: 25%;">
                    <div>Offered Time: {{ offered_time }}</div>
                </td>
                <td style="width: 25%;">
                    <div>Site Reaching Time: {{ site_reaching_time }}</div>
                </td>
                <td style="width: 25%;">
                    <div>Inspection Start Time: {{ inspection_start_time }}</div>
                </td>
                <td style="width: 25%;">
                    <div>Inspection End Time: {{ inspection_end_time }}</div>
                </td>
            </tr>
        </table>
            
        <table>
            <tr>
                <td class="subtitle">Observed Non-Conformance Statement: (with reference to documents, if any)</td>
            </tr>
            <tr>
                <td style="height: 60px;">{{ nonconformance_statement }}</td>
            </tr>
        </table>

        <table>
            <tr>
                <td colspan="4" class="subtitle">Next Steps</td>
            </tr>
            <tr>
                <td style="width: 25%;">Actions</td>
                <td style="width: 25%;">Responsibility</td>
                <td style="width: 25%;">Timelines</td>
                <td style="width: 25%;">Remarks</td>
            </tr>
            <tr style="height: 40px;">
                <td>{{ actions }}</td>
                <td>{{ responsibility }}</td>
                <td>{{ timelines }}</td>
                <td>{{ remarks }}</td>
            </tr>
        </table>

        <table>
            <tr>
                <td style="width: 15%;"></td>
                <td colspan="2" style="width: 40%; text-align: center;">EPC Representative</td>
                <td colspan="2" style="width: 45%; text-align: center;">KPIGEL Representative</td>
            </tr>
            <tr>
                <td style="width: 15%;"></td>
                <td style="width: 20%; text-align: center;">Execution</td>
                <td style="width: 20%; text-align: center;">FQA</td>
                <td style="width: 22.5%; text-align: center;">Execution</td>
                <td style="width: 22.5%; text-align: center;">FQA</td>
            </tr>
            <tr>
                <td style="width: 15%;">Sign</td>
                <td style="width: 20%; height: 30px;"></td>
                <td style="width: 20%; height: 30px;"></td>
                <td style="width: 22.5%; height: 30px;"></td>
                <td style="width: 22.5%; height: 30px;"></td>
            </tr>
            <tr>
                <td style="width: 15%;">Name</td>
                <td style="width: 20%;">{{ epc_execution_name }}</td>
                <td style="width: 20%;">{{ epc_fqa_name }}</td>
                <td style="width: 22.5%;">{{ kpi_execution_name }}</td>
                <td style="width: 22.5%;">{{ kpi_fqa_name }}</td>
            </tr>
            <tr>
                <td style="width: 15%;">Date</td>
                <td style="width: 20%;">{{ epc_execution_date }}</td>
                <td style="width: 20%;">{{ epc_fqa_date }}</td>
                <td style="width: 22.5%;">{{ kpi_execution_date }}</td>
                <td style="width: 22.5%;">{{ kpi_fqa_date }}</td>
            </tr>
        </table>
    </div>
</body>
</html>